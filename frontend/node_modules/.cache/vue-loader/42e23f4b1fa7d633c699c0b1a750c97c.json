{"remainingRequest":"D:\\桌面\\校园二手交易平台\\代码\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\桌面\\校园二手交易平台\\代码\\frontend\\src\\components\\page\\order.vue?vue&type=style&index=0&id=8b2a0244&scoped=true&lang=css&","dependencies":[{"path":"D:\\桌面\\校园二手交易平台\\代码\\frontend\\src\\components\\page\\order.vue","mtime":1745557216851},{"path":"D:\\桌面\\校园二手交易平台\\代码\\frontend\\node_modules\\css-loader\\index.js","mtime":1678197338000},{"path":"D:\\桌面\\校园二手交易平台\\代码\\frontend\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1678197338000},{"path":"D:\\桌面\\校园二手交易平台\\代码\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1678197338000},{"path":"D:\\桌面\\校园二手交易平台\\代码\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678197338000},{"path":"D:\\桌面\\校园二手交易平台\\代码\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1678197338000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.order-page-container {\n    min-height: 85vh;\n    padding: 20px;\n    background-color: #f5f7fa;\n}\n\n.order-header {\n    margin-bottom: 20px;\n    background-color: #fff;\n    padding: 15px 20px;\n    border-radius: 8px;\n    box-shadow: 0 2px 12px 0 rgba(0,0,0,0.05);\n}\n\n.order-status {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.order-id {\n    color: #606266;\n    font-size: 14px;\n}\n\n.product-card, .address-card, .order-info-card, .order-action-card {\n    margin-bottom: 20px;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.address-card-header, .order-info-header, .order-action-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-weight: 600;\n}\n\n.idle-info-container {\n    display: flex;\n    align-items: center;\n    padding: 10px;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.idle-info-container:hover {\n    background-color: #f5f7fa;\n}\n\n.product-image {\n    width: 100px;\n    height: 100px;\n    border-radius: 4px;\n    object-fit: cover;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    margin-right: 20px;\n}\n\n.product-info {\n    flex: 1;\n}\n\n.idle-info-title {\n    font-size: 16px;\n    font-weight: 600;\n    margin-bottom: 10px;\n    color: #303133;\n    display: flex;\n    align-items: center;\n}\n\n.idle-info-title i {\n    margin-right: 5px;\n    color: #409EFF;\n}\n\n.idle-info-price {\n    font-size: 20px;\n    color: #f56c6c;\n    font-weight: 600;\n}\n\n.address-container {\n    padding: 10px;\n}\n\n.clickable {\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.clickable:hover {\n    background-color: #f5f7fa;\n}\n\n.address-content {\n    padding: 10px;\n}\n\n.address-person {\n    margin-bottom: 10px;\n}\n\n.recipient-name {\n    font-weight: 600;\n    font-size: 16px;\n    margin-right: 15px;\n    color: #303133;\n}\n\n.recipient-phone {\n    color: #606266;\n}\n\n.address-details {\n    color: #606266;\n    line-height: 1.5;\n}\n\n.empty-address {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 30px 0;\n    color: #909399;\n}\n\n.empty-icon {\n    font-size: 40px;\n    color: #c0c4cc;\n    margin-bottom: 10px;\n}\n\n.empty-text {\n    margin-bottom: 15px;\n}\n\n.address-dialog {\n    border-radius: 8px;\n}\n\n.order-info-container {\n    padding: 10px;\n}\n\n.order-info-group {\n    margin-bottom: 20px;\n}\n\n.group-title {\n    font-size: 14px;\n    font-weight: 600;\n    color: #303133;\n    margin-bottom: 10px;\n    padding-bottom: 5px;\n    border-bottom: 1px solid #ebeef5;\n}\n\n.order-info-item {\n    margin: 10px 0;\n    display: flex;\n    align-items: center;\n}\n\n.info-label {\n    color: #909399;\n    width: 80px;\n    margin-right: 10px;\n}\n\n.order-actions {\n    padding: 15px;\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n    align-items: center;\n}\n\n.order-completed, .order-canceled {\n    font-size: 16px;\n    display: flex;\n    align-items: center;\n}\n\n.order-completed {\n    color: #67c23a;\n}\n\n.order-canceled {\n    color: #f56c6c;\n}\n\n.order-completed i, .order-canceled i {\n    margin-right: 5px;\n    font-size: 20px;\n}\n\n/* 响应式调整 */\n@media (max-width: 768px) {\n    .order-page-container {\n        padding: 10px;\n    }\n    \n    .product-image {\n        width: 80px;\n        height: 80px;\n        margin-right: 10px;\n    }\n    \n    .idle-info-title {\n        font-size: 14px;\n    }\n    \n    .idle-info-price {\n        font-size: 16px;\n    }\n    \n    .order-actions {\n        flex-wrap: wrap;\n        justify-content: center;\n    }\n    \n    .order-id {\n        display: none;\n    }\n    \n    .order-status {\n        justify-content: center;\n    }\n}\n",{"version":3,"sources":["order.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAybA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"order.vue","sourceRoot":"src/components/page","sourcesContent":["<template>\n    <div>\n        <app-head></app-head>\n        <app-body>\n            <div class=\"order-page-container\">\n                <div class=\"order-header\">\n                    <div class=\"order-status\">\n                        <el-tag :type=\"getStatusType(orderInfo.orderStatus)\" effect=\"dark\">\n                            {{ orderStatus[orderInfo.orderStatus] }}\n                        </el-tag>\n                        <div class=\"order-id\">订单编号: {{ orderInfo.orderNumber }}</div>\n                    </div>\n                </div>\n                \n                <el-card class=\"product-card\" shadow=\"hover\">\n                    <div class=\"idle-info-container\" @click=\"toDetails(orderInfo.idleItem.id)\">\n                        <el-image\n                            class=\"product-image\"\n                            :src=\"orderInfo.idleItem.imgUrl\"\n                            fit=\"cover\">\n                            <div slot=\"error\" class=\"image-slot\">\n                                <i class=\"el-icon-picture-outline\"></i>\n                            </div>\n                        </el-image>\n                        <div class=\"product-info\">\n                            <div class=\"idle-info-title\">\n                                <i class=\"el-icon-shopping-bag-1\"></i>\n                                {{orderInfo.userId==userId?'买到的':'卖出的'}}：{{orderInfo.idleItem.idleName}}\n                            </div>\n                            <div class=\"idle-info-price\">￥{{orderInfo.orderPrice}}</div>\n                        </div>\n                    </div>\n                </el-card>\n                \n                <el-card class=\"address-card\" shadow=\"hover\">\n                    <div slot=\"header\" class=\"address-card-header\">\n                        <span><i class=\"el-icon-location\"></i> 收货地址</span>\n                        <el-button \n                            v-if=\"orderInfo.userId==userId&&orderInfo.orderStatus===0\" \n                            type=\"text\" \n                            icon=\"el-icon-edit\"\n                            @click.stop=\"selectAddressDialog\">\n                            修改\n                        </el-button>\n                    </div>\n                    <div class=\"address-container\" :class=\"{'clickable': orderInfo.userId==userId&&orderInfo.orderStatus===0}\" @click.stop=\"selectAddressDialog\">\n                        <div v-if=\"addressInfo.detailAddress\" class=\"address-content\">\n                            <div class=\"address-person\">\n                                <span class=\"recipient-name\">{{addressInfo.consigneeName}}</span>\n                                <span class=\"recipient-phone\">{{addressInfo.consigneePhone}}</span>\n                            </div>\n                            <div class=\"address-details\">{{addressInfo.detailAddress}}</div>\n                        </div>\n                        <div v-else class=\"empty-address\">\n                            <i class=\"el-icon-map-location empty-icon\"></i>\n                            <p class=\"empty-text\">请选择收货地址</p>\n                            <el-button @click.stop=\"selectAddressDialog\" type=\"primary\" size=\"small\" icon=\"el-icon-plus\">选择收货地址</el-button>\n                        </div>\n                    </div>\n                </el-card>\n                \n                <el-dialog\n                        title=\"选择地址\"\n                        :visible.sync=\"addressDialogVisible\"\n                        width=\"800px\"\n                        custom-class=\"address-dialog\">\n                    <el-table\n                            stripe\n                            border\n                            highlight-current-row\n                            empty-text=\"无地址信息，请先在个人中心添加地址\"\n                            :data=\"addressData\"\n                            style=\"width: 100%\">\n                        <el-table-column\n                                prop=\"consigneeName\"\n                                label=\"收货人姓名\"\n                                width=\"120\">\n                        </el-table-column>\n                        <el-table-column\n                                prop=\"consigneePhone\"\n                                label=\"手机号\"\n                                width=\"140\">\n                        </el-table-column>\n                        <el-table-column\n                                prop=\"detailAddressText\"\n                                label=\"地址\">\n                        </el-table-column>\n                        <el-table-column label=\"操作\" width=\"120\" align=\"center\">\n                            <template slot-scope=\"scope\">\n                                <el-button\n                                        size=\"mini\"\n                                        type=\"primary\"\n                                        icon=\"el-icon-check\"\n                                        @click=\"selectAddress(scope.$index, scope.row)\">选择\n                                </el-button>\n                            </template>\n                        </el-table-column>\n                    </el-table>\n                    <div slot=\"footer\" class=\"dialog-footer\">\n                        <el-button @click=\"addressDialogVisible = false\">取消</el-button>\n                        <el-button type=\"primary\" @click=\"addressDialogVisible = false\">确定</el-button>\n                    </div>\n                </el-dialog>\n                \n                <el-card class=\"order-info-card\" shadow=\"hover\">\n                    <div slot=\"header\" class=\"order-info-header\">\n                        <span><i class=\"el-icon-document\"></i> 订单信息</span>\n                    </div>\n                    <div class=\"order-info-container\">\n                        <el-row :gutter=\"20\">\n                            <el-col :xs=\"24\" :sm=\"12\">\n                                <div class=\"order-info-group\">\n                                    <div class=\"group-title\">支付信息</div>\n                                    <div class=\"order-info-item\">\n                                        <span class=\"info-label\">支付状态:</span>\n                                        <el-tag size=\"small\" :type=\"orderInfo.paymentStatus === 0 ? 'warning' : 'success'\">\n                                            {{orderInfo.paymentStatus === 0 ? '未支付' : '已支付'}}\n                                        </el-tag>\n                                    </div>\n                                    <div class=\"order-info-item\">\n                                        <span class=\"info-label\">支付方式:</span>\n                                        <span>{{orderInfo.paymentWay || '暂无'}}</span>\n                                    </div>\n                                </div>\n                            </el-col>\n                            <el-col :xs=\"24\" :sm=\"12\">\n                                <div class=\"order-info-group\">\n                                    <div class=\"group-title\">时间信息</div>\n                                    <div class=\"order-info-item\">\n                                        <span class=\"info-label\">创建时间:</span>\n                                        <span>{{orderInfo.createTime ? (orderInfo.createTime.substring(0, 10) + ' ' + orderInfo.createTime.substring(11, 19)) : ''}}</span>\n                                    </div>\n                                    <div class=\"order-info-item\">\n                                        <span class=\"info-label\">支付时间:</span>\n                                        <span>{{orderInfo.paymentTime ? (orderInfo.paymentTime.substring(0, 10) + ' ' + orderInfo.paymentTime.substring(11, 19)) : '暂无'}}</span>\n                                    </div>\n                                </div>\n                            </el-col>\n                        </el-row>\n                    </div>\n                </el-card>\n                \n                <el-card class=\"order-action-card\" shadow=\"hover\">\n                    <div slot=\"header\" class=\"order-action-header\">\n                        <span><i class=\"el-icon-s-operation\"></i> 订单操作</span>\n                    </div>\n                    <div class=\"order-actions\">\n                        <el-button \n                            v-if=\"userId==orderInfo.userId&&orderInfo.orderStatus===0\" \n                            type=\"danger\" \n                            round \n                            icon=\"el-icon-close\" \n                            @click=\"changeOrderStatus(4,orderInfo)\">取消订单</el-button>\n                        <el-button \n                            v-if=\"userId==orderInfo.userId&&orderInfo.orderStatus===0\" \n                            type=\"primary\" \n                            round \n                            icon=\"el-icon-wallet\" \n                            @click=\"changeOrderStatus(1,orderInfo)\">立即支付</el-button>\n                        <el-button \n                            v-if=\"userId==orderInfo.idleItem.userId&&orderInfo.orderStatus===1\" \n                            type=\"primary\" \n                            round \n                            icon=\"el-icon-truck\" \n                            @click=\"changeOrderStatus(2,orderInfo)\">发货</el-button>\n                        <el-button \n                            v-if=\"userId==orderInfo.userId&&orderInfo.orderStatus===2\" \n                            type=\"success\" \n                            round \n                            icon=\"el-icon-check\" \n                            @click=\"changeOrderStatus(3,orderInfo)\">确认收货</el-button>\n                        <div v-if=\"orderInfo.orderStatus===3\" class=\"order-completed\">\n                            <i class=\"el-icon-circle-check\"></i> 订单已完成\n                        </div>\n                        <div v-if=\"orderInfo.orderStatus===4\" class=\"order-canceled\">\n                            <i class=\"el-icon-circle-close\"></i> 订单已取消\n                        </div>\n                    </div>\n                </el-card>\n            </div>\n            <app-foot></app-foot>\n        </app-body>\n    </div>\n</template>\n\n<script>\n    import AppHead from '../common/AppHeader.vue';\n    import AppBody from '../common/AppPageBody.vue'\n    import AppFoot from '../common/AppFoot.vue'\n\n    export default {\n        name: \"order\",\n        components: {\n            AppHead,\n            AppBody,\n            AppFoot\n        },\n        data() {\n            return {\n                addressDialogVisible:false,\n                addressData: [],\n                orderStatus: ['待付款', '待发货', '待收货', '已完成', '已取消'],\n                orderInfo: {\n                    createTime: \"\",\n                    id: 0,\n                    idleId: 0,\n                    idleItem: {\n                        id: '',\n                        idleName: '',\n                        idleDetails: '',\n                        pictureList: [],\n                        idlePrice: 0,\n                        idlePlace: '',\n                        idleLabel: '',\n                        idleStatus: -1,\n                        userId: '',\n                        imgUrl:''\n                    },\n                    orderNumber: \"\",\n                    orderPrice: 0,\n                    orderStatus: 0,\n                    paymentStatus: 0,\n                    paymentTime: \"\",\n                    paymentWay: \"\",\n                    userId: 0\n                },\n                addressInfo: {\n                    id:'',\n                    update:false,\n                    consigneeName: '',\n                    consigneePhone: '',\n                    detailAddress: ''\n                },\n                userId:''\n            };\n        },\n        mounted(){\n            this.$nextTick(()=>{\n                this.userId=this.getCookie('shUserId');\n                console.log('userId',this.userId,this.getCookie('shUserId'));\n                let orderId = this.$route.query.id;\n                console.log(orderId);\n                this.$api.getOrder({\n                    id: orderId\n                }).then(res => {\n                    console.log(res);\n                    if (res.status_code === 1) {\n                        if (res.data.idleItem) {\n                            let imgList = JSON.parse(res.data.idleItem.pictureList);\n                            if (imgList.length > 0) {\n                                res.data.idleItem.imgUrl = imgList[0];\n                            } else {\n                                res.data.idleItem.imgUrl = '';\n                            }\n                        } else {\n                            res.data.idleItem = {\n                                idleName: '',\n                                imgUrl: ''\n                            }\n                        }\n                        this.orderInfo = res.data;\n                        this.$api.getOrderAddress({\n                            orderId:this.orderInfo.id\n                        }).then(res=>{\n                            if(res.data){\n                                this.addressInfo= res.data;\n                                this.addressInfo.update=true;\n                            }else{\n                                this.getAddressData();\n                            }\n                        })\n                    }\n                })\n            })\n        },\n        created() {\n            \n            \n        },\n        methods: {\n            getStatusType(status) {\n                const types = ['warning', 'primary', 'info', 'success', 'danger'];\n                return types[status] || 'info';\n            },\n            getCookie(cname){\n                var name = cname + \"=\";\n                var ca = document.cookie.split(';');\n                for(var i=0; i<ca.length; i++)\n                {\n                    var c = ca[i].trim();\n                    if (c.indexOf(name)===0) return c.substring(name.length,c.length);\n                }\n                return \"0\";\n            },\n            toDetails(id) {\n                this.$router.replace({path: 'details', query: {id: id}});\n            },\n            selectAddressDialog(){\n                if(this.orderInfo.userId==this.userId&&this.orderInfo.orderStatus===0){\n                    this.addressDialogVisible=true;\n                    if(this.addressData.length===0){\n                        this.getAddressData();\n                    }\n                }\n            },\n            getAddressData(){\n                this.$api.getAddress().then(res => {\n                    if (res.status_code === 1) {\n                        let data = res.data;\n                        for (let i = 0; i < data.length; i++) {\n                            data[i].detailAddressText = data[i].provinceName + data[i].cityName + data[i].regionName + data[i].detailAddress;\n                        }\n                        console.log(data);\n                        this.addressData = data;\n                        if(!this.addressInfo.update){\n                            for(let i=0;i<data.length;i++){\n                                if(data[i].defaultFlag){\n                                    this.selectAddress(i,data[i]);\n                                }\n                            }\n                        }\n                    }\n                })\n            },\n            selectAddress(i,item){\n                this.addressDialogVisible=false;\n                console.log(item,this.addressInfo);\n                this.addressInfo.consigneeName=item.consigneeName;\n                this.addressInfo.consigneePhone=item.consigneePhone;\n                this.addressInfo.detailAddress=item.detailAddressText;\n                if(this.addressInfo.update){\n                    this.$api.updateOrderAddress({\n                        id:this.addressInfo.id,\n                        consigneeName:item.consigneeName,\n                        consigneePhone:item.consigneePhone,\n                        detailAddress:item.detailAddressText\n                    })\n                }else{\n                    this.$api.addOrderAddress({\n                        orderId:this.orderInfo.id,\n                        consigneeName:item.consigneeName,\n                        consigneePhone:item.consigneePhone,\n                        detailAddress:item.detailAddressText\n                    }).then(res=>{\n                        if(res.status_code===1){\n                            this.addressInfo.update=true;\n                            this.addressInfo.id=res.data.id;\n                        }else {\n                            this.$message.error(res.msg)\n                        }\n                    })\n                }\n\n            },\n            changeOrderStatus(orderStatus, orderInfo) {\n                if (orderStatus === 1) {\n                    console.log('开始支付流程:', orderInfo);\n                    if(!this.addressInfo.detailAddress){\n                        this.$message.error('请选择地址！')\n                    }else{\n                        this.$confirm('模拟支付宝支付，是否确认支付', '支付订单', {\n                            confirmButtonText: '支付',\n                            cancelButtonText: '取消',\n                            type: 'warning'\n                        }).then(() => {\n                            this.$api.updateOrder({\n                                id: orderInfo.id,\n                                orderStatus: orderStatus,\n                                paymentStatus: 1,\n                                paymentWay: '支付宝',\n                            }).then(res => {\n                                console.log('订单更新返回结果:', res);\n                                \n                                // 获取订单数据\n                                let orderId = orderInfo.id.toString();\n                                let orderNo = orderInfo.orderNumber ? orderInfo.orderNumber.toString() : '';\n                                let orderPrice = orderInfo.orderPrice ? orderInfo.orderPrice.toString() : '0';\n                                \n                                // 更新本地订单状态\n                                if (res.status_code === 1) {\n                                    this.orderInfo.orderStatus = orderStatus;\n                                    this.orderInfo.paymentStatus = 1;\n                                    this.orderInfo.paymentWay = '支付宝';\n                                    this.orderInfo.paymentTime = res.data.paymentTime;\n                                    \n                                    // 显示支付成功消息\n                                    this.$message({\n                                        message: '订单状态已更新，正在跳转...',\n                                        type: 'success'\n                                    });\n                                }\n                                \n                                // 构建更可靠的支付成功页面URL\n                                const baseUrl = window.location.origin;\n                                const hashPrefix = baseUrl.includes('8081') ? '/#' : '';\n\n                                // 确保参数不包含前后不必要的空格\n                                const cleanOrderId = String(orderId).trim();\n                                const cleanOrderNo = String(orderNo).trim();\n                                const cleanPrice = String(orderPrice).trim();\n\n                                // 使用最原始的方式构建URL参数\n                                const paySuccessUrl = `${baseUrl}${hashPrefix}/alipay/pay?name=${cleanOrderId}&no=${cleanOrderNo}&price=${cleanPrice}`;\n\n                                console.log('最终跳转URL:', paySuccessUrl);\n                                \n                                // 使用延时确保状态更新后再跳转\n                                setTimeout(() => {\n                                    // 使用location.replace避免浏览器历史堆积\n                                    window.location.replace(paySuccessUrl);\n                                }, 500);\n                                \n                            }).catch(err => {\n                                console.error('支付请求失败:', err);\n                                this.$message.error('支付请求失败，请稍后重试');\n                            });\n                        }).catch(() => {\n                            // 用户取消支付\n                        });\n                    }\n                } else {\n                    this.$api.updateOrder({\n                        id: orderInfo.id,\n                        orderStatus: orderStatus,\n                    }).then(res => {\n                        if (res.status_code === 1) {\n                            this.$message({\n                                message: '操作成功！',\n                                type: 'success'\n                            });\n                            this.orderInfo.orderStatus = orderStatus;\n                        }\n                    })\n                }\n            },\n        }\n\n    }\n</script>\n\n<style scoped>\n    .order-page-container {\n        min-height: 85vh;\n        padding: 20px;\n        background-color: #f5f7fa;\n    }\n    \n    .order-header {\n        margin-bottom: 20px;\n        background-color: #fff;\n        padding: 15px 20px;\n        border-radius: 8px;\n        box-shadow: 0 2px 12px 0 rgba(0,0,0,0.05);\n    }\n    \n    .order-status {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n    \n    .order-id {\n        color: #606266;\n        font-size: 14px;\n    }\n    \n    .product-card, .address-card, .order-info-card, .order-action-card {\n        margin-bottom: 20px;\n        border-radius: 8px;\n        overflow: hidden;\n    }\n    \n    .address-card-header, .order-info-header, .order-action-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        font-weight: 600;\n    }\n    \n    .idle-info-container {\n        display: flex;\n        align-items: center;\n        padding: 10px;\n        cursor: pointer;\n        transition: all 0.3s;\n    }\n    \n    .idle-info-container:hover {\n        background-color: #f5f7fa;\n    }\n    \n    .product-image {\n        width: 100px;\n        height: 100px;\n        border-radius: 4px;\n        object-fit: cover;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        margin-right: 20px;\n    }\n    \n    .product-info {\n        flex: 1;\n    }\n    \n    .idle-info-title {\n        font-size: 16px;\n        font-weight: 600;\n        margin-bottom: 10px;\n        color: #303133;\n        display: flex;\n        align-items: center;\n    }\n    \n    .idle-info-title i {\n        margin-right: 5px;\n        color: #409EFF;\n    }\n    \n    .idle-info-price {\n        font-size: 20px;\n        color: #f56c6c;\n        font-weight: 600;\n    }\n    \n    .address-container {\n        padding: 10px;\n    }\n    \n    .clickable {\n        cursor: pointer;\n        transition: all 0.3s;\n    }\n    \n    .clickable:hover {\n        background-color: #f5f7fa;\n    }\n    \n    .address-content {\n        padding: 10px;\n    }\n    \n    .address-person {\n        margin-bottom: 10px;\n    }\n    \n    .recipient-name {\n        font-weight: 600;\n        font-size: 16px;\n        margin-right: 15px;\n        color: #303133;\n    }\n    \n    .recipient-phone {\n        color: #606266;\n    }\n    \n    .address-details {\n        color: #606266;\n        line-height: 1.5;\n    }\n    \n    .empty-address {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        padding: 30px 0;\n        color: #909399;\n    }\n    \n    .empty-icon {\n        font-size: 40px;\n        color: #c0c4cc;\n        margin-bottom: 10px;\n    }\n    \n    .empty-text {\n        margin-bottom: 15px;\n    }\n    \n    .address-dialog {\n        border-radius: 8px;\n    }\n    \n    .order-info-container {\n        padding: 10px;\n    }\n    \n    .order-info-group {\n        margin-bottom: 20px;\n    }\n    \n    .group-title {\n        font-size: 14px;\n        font-weight: 600;\n        color: #303133;\n        margin-bottom: 10px;\n        padding-bottom: 5px;\n        border-bottom: 1px solid #ebeef5;\n    }\n    \n    .order-info-item {\n        margin: 10px 0;\n        display: flex;\n        align-items: center;\n    }\n    \n    .info-label {\n        color: #909399;\n        width: 80px;\n        margin-right: 10px;\n    }\n    \n    .order-actions {\n        padding: 15px;\n        display: flex;\n        justify-content: flex-end;\n        gap: 10px;\n        align-items: center;\n    }\n    \n    .order-completed, .order-canceled {\n        font-size: 16px;\n        display: flex;\n        align-items: center;\n    }\n    \n    .order-completed {\n        color: #67c23a;\n    }\n    \n    .order-canceled {\n        color: #f56c6c;\n    }\n    \n    .order-completed i, .order-canceled i {\n        margin-right: 5px;\n        font-size: 20px;\n    }\n    \n    /* 响应式调整 */\n    @media (max-width: 768px) {\n        .order-page-container {\n            padding: 10px;\n        }\n        \n        .product-image {\n            width: 80px;\n            height: 80px;\n            margin-right: 10px;\n        }\n        \n        .idle-info-title {\n            font-size: 14px;\n        }\n        \n        .idle-info-price {\n            font-size: 16px;\n        }\n        \n        .order-actions {\n            flex-wrap: wrap;\n            justify-content: center;\n        }\n        \n        .order-id {\n            display: none;\n        }\n        \n        .order-status {\n            justify-content: center;\n        }\n    }\n</style>"]}]}