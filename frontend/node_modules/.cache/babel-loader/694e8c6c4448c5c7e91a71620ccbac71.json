{"remainingRequest":"F:\\桌面\\校园二手交易平台\\校园二手交易平台\\校园二手交易平台\\代码\\frontend\\node_modules\\babel-loader\\lib\\index.js!F:\\桌面\\校园二手交易平台\\校园二手交易平台\\校园二手交易平台\\代码\\frontend\\src\\utils\\request.js","dependencies":[{"path":"F:\\桌面\\校园二手交易平台\\校园二手交易平台\\校园二手交易平台\\代码\\frontend\\src\\utils\\request.js","mtime":1766975105213},{"path":"F:\\桌面\\校园二手交易平台\\校园二手交易平台\\校园二手交易平台\\代码\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678197338000},{"path":"F:\\桌面\\校园二手交易平台\\校园二手交易平台\\校园二手交易平台\\代码\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1678197338000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport axios from 'axios';\n/* 1. 新增：读取Cookie的工具函数（放在最顶部，import之后） */\n\nfunction getCookie(name) {\n  var value = \"; \".concat(document.cookie);\n  var parts = value.split(\"; \".concat(name, \"=\"));\n  if (parts.length === 2) return parts.pop().split(';').shift();\n}\n/* axios功能封装  */\n\n\nvar service = axios.create({\n  timeout: 5000,\n  // baseURL:  'http://localhost:8080',\n  withCredentials: true\n}); // request interceptor(请求拦截器)\n\nservice.interceptors.request.use(function (config) {\n  /* 2. 新增：读取_xsrf令牌并添加到请求头 */\n  var xsrfToken = getCookie('_xsrf'); // 读取Cookie里的_xsrf\n\n  if (xsrfToken) {\n    // 把令牌添加到请求头，后端会识别这个头验证CSRF\n    config.headers['X-XSRF-TOKEN'] = xsrfToken;\n  }\n\n  return config;\n}, function (error) {\n  console.log(error);\n  return Promise.reject(error); // 补充：把error传递出去，方便前端捕获\n}); // response interceptor（接收拦截器）\n\nservice.interceptors.response.use(function (response) {\n  if (response.status === 200) {\n    return response.data;\n  } else {\n    return Promise.reject(response); // 补充：传递错误响应\n  }\n}, function (error) {\n  console.log('请求错误：', error); // 优化：打印具体错误信息\n\n  return Promise.reject(error); // 补充：把error传递出去\n});\nexport default service;",{"version":3,"sources":["F:/桌面/校园二手交易平台/校园二手交易平台/校园二手交易平台/代码/frontend/src/utils/request.js"],"names":["axios","getCookie","name","value","document","cookie","parts","split","length","pop","shift","service","create","timeout","withCredentials","interceptors","request","use","config","xsrfToken","headers","error","console","log","Promise","reject","response","status","data"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA;;AACA,SAASC,SAAT,CAAmBC,IAAnB,EAAyB;AACvB,MAAMC,KAAK,eAAQC,QAAQ,CAACC,MAAjB,CAAX;AACA,MAAMC,KAAK,GAAGH,KAAK,CAACI,KAAN,aAAiBL,IAAjB,OAAd;AACA,MAAII,KAAK,CAACE,MAAN,KAAiB,CAArB,EAAwB,OAAOF,KAAK,CAACG,GAAN,GAAYF,KAAZ,CAAkB,GAAlB,EAAuBG,KAAvB,EAAP;AACzB;AAED;;;AACA,IAAMC,OAAO,GAAGX,KAAK,CAACY,MAAN,CAAa;AACzBC,EAAAA,OAAO,EAAE,IADgB;AAEzB;AACAC,EAAAA,eAAe,EAAG;AAHO,CAAb,CAAhB,C,CAMA;;AACAH,OAAO,CAACI,YAAR,CAAqBC,OAArB,CAA6BC,GAA7B,CACI,UAAAC,MAAM,EAAI;AACN;AACA,MAAMC,SAAS,GAAGlB,SAAS,CAAC,OAAD,CAA3B,CAFM,CAEgC;;AACtC,MAAIkB,SAAJ,EAAe;AACX;AACAD,IAAAA,MAAM,CAACE,OAAP,CAAe,cAAf,IAAiCD,SAAjC;AACH;;AACD,SAAOD,MAAP;AACH,CATL,EAUI,UAAAG,KAAK,EAAI;AACLC,EAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACA,SAAOG,OAAO,CAACC,MAAR,CAAeJ,KAAf,CAAP,CAFK,CAEyB;AACjC,CAbL,E,CAgBA;;AACAV,OAAO,CAACI,YAAR,CAAqBW,QAArB,CAA8BT,GAA9B,CACI,UAAAS,QAAQ,EAAI;AACR,MAAIA,QAAQ,CAACC,MAAT,KAAoB,GAAxB,EAA6B;AACzB,WAAOD,QAAQ,CAACE,IAAhB;AACH,GAFD,MAEO;AACH,WAAOJ,OAAO,CAACC,MAAR,CAAeC,QAAf,CAAP,CADG,CAC8B;AACpC;AACJ,CAPL,EAQI,UAAAL,KAAK,EAAI;AACLC,EAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBF,KAArB,EADK,CACwB;;AAC7B,SAAOG,OAAO,CAACC,MAAR,CAAeJ,KAAf,CAAP,CAFK,CAEyB;AACjC,CAXL;AAcA,eAAeV,OAAf","sourcesContent":["import axios from 'axios';\n\n/* 1. 新增：读取Cookie的工具函数（放在最顶部，import之后） */\nfunction getCookie(name) {\n  const value = `; ${document.cookie}`;\n  const parts = value.split(`; ${name}=`);\n  if (parts.length === 2) return parts.pop().split(';').shift();\n}\n\n/* axios功能封装  */\nconst service = axios.create({\n    timeout: 5000,\n    // baseURL:  'http://localhost:8080',\n    withCredentials:  true\n});\n\n// request interceptor(请求拦截器)\nservice.interceptors.request.use(\n    config => {\n        /* 2. 新增：读取_xsrf令牌并添加到请求头 */\n        const xsrfToken = getCookie('_xsrf'); // 读取Cookie里的_xsrf\n        if (xsrfToken) {\n            // 把令牌添加到请求头，后端会识别这个头验证CSRF\n            config.headers['X-XSRF-TOKEN'] = xsrfToken; \n        }\n        return config;\n    },\n    error => {\n        console.log(error);\n        return Promise.reject(error); // 补充：把error传递出去，方便前端捕获\n    }\n);\n\n// response interceptor（接收拦截器）\nservice.interceptors.response.use(\n    response => {\n        if (response.status === 200) {\n            return response.data;\n        } else {\n            return Promise.reject(response); // 补充：传递错误响应\n        }\n    },\n    error => {\n        console.log('请求错误：', error); // 优化：打印具体错误信息\n        return Promise.reject(error); // 补充：把error传递出去\n    }\n);\n\nexport default service;"]}]}