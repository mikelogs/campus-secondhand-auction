{"remainingRequest":"E:\\project\\secondhandShop\\leave unused-goods-trading-platform -front\\node_modules\\babel-loader\\lib\\index.js!E:\\project\\secondhandShop\\leave unused-goods-trading-platform -front\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\project\\secondhandShop\\leave unused-goods-trading-platform -front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\project\\secondhandShop\\leave unused-goods-trading-platform -front\\src\\components\\page\\order.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\project\\secondhandShop\\leave unused-goods-trading-platform -front\\src\\components\\page\\order.vue","mtime":1652359282028},{"path":"E:\\project\\secondhandShop\\leave unused-goods-trading-platform -front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645787918793},{"path":"E:\\project\\secondhandShop\\leave unused-goods-trading-platform -front\\node_modules\\babel-loader\\lib\\index.js","mtime":1645787919664},{"path":"E:\\project\\secondhandShop\\leave unused-goods-trading-platform -front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645787918793},{"path":"E:\\project\\secondhandShop\\leave unused-goods-trading-platform -front\\node_modules\\vue-loader\\lib\\index.js","mtime":1645787910416}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.regexp.split\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport AppHead from \"../common/AppHeader.vue\";\nimport AppBody from \"../common/AppPageBody.vue\";\nimport AppFoot from \"../common/AppFoot.vue\";\nexport default {\n  name: \"order\",\n  components: {\n    AppHead: AppHead,\n    AppBody: AppBody,\n    AppFoot: AppFoot\n  },\n  data: function data() {\n    return {\n      addressDialogVisible: false,\n      addressData: [],\n      orderStatus: ['待付款', '待发货', '待收货', '已完成', '已取消'],\n      orderInfo: {\n        createTime: \"\",\n        id: 0,\n        idleId: 0,\n        idleItem: {\n          id: '',\n          idleName: '',\n          idleDetails: '',\n          pictureList: [],\n          idlePrice: 0,\n          idlePlace: '',\n          idleLabel: '',\n          idleStatus: -1,\n          userId: ''\n        },\n        orderNumber: \"\",\n        orderPrice: 0,\n        orderStatus: 0,\n        paymentStatus: 0,\n        paymentTime: \"\",\n        paymentWay: \"\",\n        userId: 0\n      },\n      addressInfo: {\n        id: '',\n        update: false,\n        consigneeName: '',\n        consigneePhone: '',\n        detailAddress: ''\n      },\n      userId: ''\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    this.userId = this.getCookie('shUserId');\n    console.log('userId', this.userId, this.getCookie('shUserId'));\n    var orderId = this.$route.query.id;\n    console.log(orderId);\n    this.$api.getOrder({\n      id: orderId\n    }).then(function (res) {\n      console.log(res);\n\n      if (res.status_code === 1) {\n        if (res.data.idleItem) {\n          var imgList = JSON.parse(res.data.idleItem.pictureList);\n\n          if (imgList.length > 0) {\n            res.data.idleItem.imgUrl = imgList[0];\n          } else {\n            res.data.idleItem.imgUrl = '';\n          }\n        } else {\n          res.data.idleItem = {\n            idleName: '',\n            imgUrl: ''\n          };\n        }\n\n        _this.orderInfo = res.data;\n\n        _this.$api.getOrderAddress({\n          orderId: _this.orderInfo.id\n        }).then(function (res) {\n          if (res.data) {\n            _this.addressInfo = res.data;\n            _this.addressInfo.update = true;\n          } else {\n            _this.getAddressData();\n          }\n        });\n      }\n    });\n  },\n  methods: {\n    getCookie: function getCookie(cname) {\n      var name = cname + \"=\";\n      var ca = document.cookie.split(';');\n\n      for (var i = 0; i < ca.length; i++) {\n        var c = ca[i].trim();\n        if (c.indexOf(name) === 0) return c.substring(name.length, c.length);\n      }\n\n      return \"0\";\n    },\n    toDetails: function toDetails(id) {\n      this.$router.replace({\n        path: 'details',\n        query: {\n          id: id\n        }\n      });\n    },\n    selectAddressDialog: function selectAddressDialog() {\n      if (this.orderInfo.userId == this.userId && this.orderInfo.orderStatus === 0) {\n        this.addressDialogVisible = true;\n\n        if (this.addressData.length === 0) {\n          this.getAddressData();\n        }\n      }\n    },\n    getAddressData: function getAddressData() {\n      var _this2 = this;\n\n      this.$api.getAddress().then(function (res) {\n        if (res.status_code === 1) {\n          var data = res.data;\n\n          for (var i = 0; i < data.length; i++) {\n            data[i].detailAddressText = data[i].provinceName + data[i].cityName + data[i].regionName + data[i].detailAddress;\n          }\n\n          console.log(data);\n          _this2.addressData = data;\n\n          if (!_this2.addressInfo.update) {\n            for (var _i = 0; _i < data.length; _i++) {\n              if (data[_i].defaultFlag) {\n                _this2.selectAddress(_i, data[_i]);\n              }\n            }\n          }\n        }\n      });\n    },\n    selectAddress: function selectAddress(i, item) {\n      var _this3 = this;\n\n      this.addressDialogVisible = false;\n      console.log(item, this.addressInfo);\n      this.addressInfo.consigneeName = item.consigneeName;\n      this.addressInfo.consigneePhone = item.consigneePhone;\n      this.addressInfo.detailAddress = item.detailAddressText;\n\n      if (this.addressInfo.update) {\n        this.$api.updateOrderAddress({\n          id: this.addressInfo.id,\n          consigneeName: item.consigneeName,\n          consigneePhone: item.consigneePhone,\n          detailAddress: item.detailAddressText\n        });\n      } else {\n        this.$api.addOrderAddress({\n          orderId: this.orderInfo.id,\n          consigneeName: item.consigneeName,\n          consigneePhone: item.consigneePhone,\n          detailAddress: item.detailAddressText\n        }).then(function (res) {\n          if (res.status_code === 1) {\n            _this3.addressInfo.update = true;\n            _this3.addressInfo.id = res.data.id;\n          } else {\n            _this3.$message.error(res.msg);\n          }\n        });\n      }\n    },\n    changeOrderStatus: function changeOrderStatus(orderStatus, orderInfo) {\n      var _this4 = this;\n\n      if (orderStatus === 1) {\n        console.log('zhifu');\n\n        if (!this.addressInfo.detailAddress) {\n          this.$message.error('请选择地址！');\n        } else {\n          this.$confirm('模拟支付宝支付，是否确认支付', '支付订单', {\n            confirmButtonText: '支付',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }).then(function () {\n            _this4.$api.updateOrder({\n              id: orderInfo.id,\n              orderStatus: orderStatus,\n              paymentStatus: 1,\n              paymentWay: '支付宝'\n            }).then(function (res) {\n              var address = \"http://localhost:8080/alipay/pay?name=\" + orderInfo.id + \"&no=\" + Math.random().toString(36).substr(2) + \"&price=\" + orderInfo.idleItem.idlePrice;\n              console.log(res.data[0]); // res.data.\n\n              window.open(address);\n\n              if (res.status_code === 1) {\n                _this4.$message({\n                  message: '支付成功！',\n                  type: 'success'\n                });\n\n                _this4.orderInfo.orderStatus = orderStatus;\n                _this4.orderInfo.paymentStatus = 1;\n                _this4.orderInfo.paymentWay = '支付宝';\n                _this4.orderInfo.paymentTime = res.data.paymentTime;\n              }\n            });\n          }).catch(function () {});\n        }\n      } else {\n        this.$api.updateOrder({\n          id: orderInfo.id,\n          orderStatus: orderStatus\n        }).then(function (res) {\n          if (res.status_code === 1) {\n            _this4.$message({\n              message: '操作成功！',\n              type: 'success'\n            });\n\n            _this4.orderInfo.orderStatus = orderStatus;\n          }\n        });\n      }\n    }\n  }\n};",{"version":3,"sources":["order.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div>\n        <app-head></app-head>\n        <app-body>\n            <div class=\"order-page-container\">\n                <div class=\"idle-info-container\" @click=\"toDetails(orderInfo.idleItem.id)\">\n                    <el-image\n                            style=\"width: 150px; height: 150px;\"\n                            :src=\"orderInfo.idleItem.imgUrl\"\n                            fit=\"cover\"></el-image>\n                    <div class=\"idle-info-title\">{{orderInfo.userId==userId?'买到的':'卖出的'}}：{{orderInfo.idleItem.idleName}}</div>\n                    <div class=\"idle-info-price\">￥{{orderInfo.orderPrice}}</div>\n\n                </div>\n                <div class=\"address-container\" @click.stop=\"selectAddressDialog\" :style=\"orderInfo.userId==userId&&orderInfo.orderStatus===0?'cursor: pointer;':''\">\n                    <div class=\"address-title\">收货地址: {{addressInfo.consigneeName}} {{addressInfo.consigneePhone}}</div>\n                    <div class=\"address-detials\">{{addressInfo.detailAddress}}</div>\n                    <el-button v-if=\"!addressInfo.detailAddress\" @click.stop=\"selectAddressDialog\" type=\"primary\" plain>选择收货地址</el-button>\n                </div>\n                <el-dialog\n                        title=\"选择地址\"\n                        :visible.sync=\"addressDialogVisible\"\n                        width=\"800px\">\n                    <el-table\n                            stripe\n                            empty-text=\"无地址信息，请先在个人中心添加地址\"\n                            :data=\"addressData\"\n                            style=\"width: 100%\">\n                        <el-table-column\n                                prop=\"consigneeName\"\n                                label=\"收货人姓名\"\n                                width=\"120\">\n                        </el-table-column>\n                        <el-table-column\n                                prop=\"consigneePhone\"\n                                label=\"手机号\"\n                                width=\"140\">\n                        </el-table-column>\n                        <el-table-column\n                                prop=\"detailAddressText\"\n                                label=\"地址\">\n                        </el-table-column>\n                        <el-table-column label=\" \" width=\"120\">\n                            <template slot-scope=\"scope\">\n                                <el-button\n                                        size=\"mini\"\n                                        @click=\"selectAddress(scope.$index, scope.row)\">选择\n                                </el-button>\n                            </template>\n                        </el-table-column>\n                    </el-table>\n                </el-dialog>\n                <div class=\"order-info-container\">\n                    <div class=\"order-info-title\">订单信息（{{orderStatus[orderInfo.orderStatus]}}）：</div>\n                    <div class=\"order-info-item\">编号：{{orderInfo.orderNumber}}</div>\n                    <div class=\"order-info-item\">支付状态：{{orderInfo.paymentStatus===0?'未支付':'已支付'}}</div>\n                    <div class=\"order-info-item\">支付方式：{{orderInfo.paymentWay}}</div>\n                    <div class=\"order-info-item\">创建时间：{{orderInfo.createTime.substring(0, 10) + ' ' +\n                        orderInfo.createTime.substring(11, 19)}}\n                    </div>\n                    <div class=\"order-info-item\">支付时间：{{orderInfo.paymentTime?orderInfo.paymentTime.substring(0, 10) + ' ' +\n                        orderInfo.paymentTime.substring(11, 19):''}}\n                    </div>\n                </div>\n                <div class=\"menu\">\n                    <el-button v-if=\"userId==orderInfo.userId&&orderInfo.orderStatus===0\" type=\"danger\" plain @click=\"changeOrderStatus(4,orderInfo)\">取消订单</el-button>\n                    <el-button v-if=\"userId==orderInfo.userId&&orderInfo.orderStatus===0\" type=\"primary\" plain @click=\"changeOrderStatus(1,orderInfo)\">立即支付</el-button>\n                    <el-button v-if=\"userId==orderInfo.idleItem.userId&&orderInfo.orderStatus===1\" type=\"primary\" plain @click=\"changeOrderStatus(2,orderInfo)\">发货</el-button>\n                    <el-button v-if=\"userId==orderInfo.userId&&orderInfo.orderStatus===2\" type=\"primary\" plain @click=\"changeOrderStatus(3,orderInfo)\">确认收货</el-button>\n                </div>\n            </div>\n            <app-foot></app-foot>\n        </app-body>\n    </div>\n</template>\n\n<script>\n    import AppHead from '../common/AppHeader.vue';\n    import AppBody from '../common/AppPageBody.vue'\n    import AppFoot from '../common/AppFoot.vue'\n\n    export default {\n        name: \"order\",\n        components: {\n            AppHead,\n            AppBody,\n            AppFoot\n        },\n        data() {\n            return {\n                addressDialogVisible:false,\n                addressData: [],\n                orderStatus: ['待付款', '待发货', '待收货', '已完成', '已取消'],\n                orderInfo: {\n                    createTime: \"\",\n                    id: 0,\n                    idleId: 0,\n                    idleItem: {\n                        id: '',\n                        idleName: '',\n                        idleDetails: '',\n                        pictureList: [],\n                        idlePrice: 0,\n                        idlePlace: '',\n                        idleLabel: '',\n                        idleStatus: -1,\n                        userId: '',\n                    },\n                    orderNumber: \"\",\n                    orderPrice: 0,\n                    orderStatus: 0,\n                    paymentStatus: 0,\n                    paymentTime: \"\",\n                    paymentWay: \"\",\n                    userId: 0\n                },\n                addressInfo: {\n                    id:'',\n                    update:false,\n                    consigneeName: '',\n                    consigneePhone: '',\n                    detailAddress: ''\n                },\n                userId:''\n            };\n        },\n        created() {\n            this.userId=this.getCookie('shUserId');\n            console.log('userId',this.userId,this.getCookie('shUserId'));\n            let orderId = this.$route.query.id;\n            console.log(orderId);\n            this.$api.getOrder({\n                id: orderId\n            }).then(res => {\n                console.log(res);\n                if (res.status_code === 1) {\n                    if (res.data.idleItem) {\n                        let imgList = JSON.parse(res.data.idleItem.pictureList);\n                        if (imgList.length > 0) {\n                            res.data.idleItem.imgUrl = imgList[0];\n                        } else {\n                            res.data.idleItem.imgUrl = '';\n                        }\n                    } else {\n                        res.data.idleItem = {\n                            idleName: '',\n                            imgUrl: ''\n                        }\n                    }\n                    this.orderInfo = res.data;\n                    this.$api.getOrderAddress({\n                        orderId:this.orderInfo.id\n                    }).then(res=>{\n                        if(res.data){\n                            this.addressInfo= res.data;\n                            this.addressInfo.update=true;\n                        }else{\n                            this.getAddressData();\n                        }\n                    })\n                }\n            })\n        },\n        methods: {\n            getCookie(cname){\n                var name = cname + \"=\";\n                var ca = document.cookie.split(';');\n                for(var i=0; i<ca.length; i++)\n                {\n                    var c = ca[i].trim();\n                    if (c.indexOf(name)===0) return c.substring(name.length,c.length);\n                }\n                return \"0\";\n            },\n            toDetails(id) {\n                this.$router.replace({path: 'details', query: {id: id}});\n            },\n            selectAddressDialog(){\n                if(this.orderInfo.userId==this.userId&&this.orderInfo.orderStatus===0){\n                    this.addressDialogVisible=true;\n                    if(this.addressData.length===0){\n                        this.getAddressData();\n                    }\n                }\n            },\n            getAddressData(){\n                this.$api.getAddress().then(res => {\n                    if (res.status_code === 1) {\n                        let data = res.data;\n                        for (let i = 0; i < data.length; i++) {\n                            data[i].detailAddressText = data[i].provinceName + data[i].cityName + data[i].regionName + data[i].detailAddress;\n                        }\n                        console.log(data);\n                        this.addressData = data;\n                        if(!this.addressInfo.update){\n                            for(let i=0;i<data.length;i++){\n                                if(data[i].defaultFlag){\n                                    this.selectAddress(i,data[i]);\n                                }\n                            }\n                        }\n                    }\n                })\n            },\n            selectAddress(i,item){\n                this.addressDialogVisible=false;\n                console.log(item,this.addressInfo);\n                this.addressInfo.consigneeName=item.consigneeName;\n                this.addressInfo.consigneePhone=item.consigneePhone;\n                this.addressInfo.detailAddress=item.detailAddressText;\n                if(this.addressInfo.update){\n                    this.$api.updateOrderAddress({\n                        id:this.addressInfo.id,\n                        consigneeName:item.consigneeName,\n                        consigneePhone:item.consigneePhone,\n                        detailAddress:item.detailAddressText\n                    })\n                }else{\n                    this.$api.addOrderAddress({\n                        orderId:this.orderInfo.id,\n                        consigneeName:item.consigneeName,\n                        consigneePhone:item.consigneePhone,\n                        detailAddress:item.detailAddressText\n                    }).then(res=>{\n                        if(res.status_code===1){\n                            this.addressInfo.update=true;\n                            this.addressInfo.id=res.data.id;\n                        }else {\n                            this.$message.error(res.msg)\n                        }\n                    })\n                }\n\n            },\n            changeOrderStatus(orderStatus, orderInfo) {\n                if (orderStatus === 1) {\n                    console.log('zhifu');\n                    if(!this.addressInfo.detailAddress){\n                        this.$message.error('请选择地址！')\n                    }else{\n                        this.$confirm('模拟支付宝支付，是否确认支付', '支付订单', {\n                            confirmButtonText: '支付',\n                            cancelButtonText: '取消',\n                            type: 'warning'\n                        }).then(() => {\n\n                                this.$api.updateOrder({\n                                    id: orderInfo.id,\n                                    orderStatus: orderStatus,\n                                    paymentStatus: 1,\n                                    paymentWay: '支付宝',\n                                }).then(res => {\n\n\n                                    var address = \"http://localhost:8080/alipay/pay?name=\" + orderInfo.id + \"&no=\"+\n                                      Math.random().toString(36).substr(2) + \"&price=\" + orderInfo.idleItem.idlePrice;\n\n                                    console.log(res.data[0]);\n                                    // res.data.\n                                    window.open(address)\n\n                                    if (res.status_code === 1) {\n                                        this.$message({\n                                            message: '支付成功！',\n                                            type: 'success'\n                                        });\n                                        this.orderInfo.orderStatus = orderStatus;\n                                        this.orderInfo.paymentStatus = 1;\n                                        this.orderInfo.paymentWay = '支付宝';\n                                        this.orderInfo.paymentTime = res.data.paymentTime;\n                                    }\n                                })\n\n                        }).catch(() => {\n                        });\n                    }\n                } else {\n                    this.$api.updateOrder({\n                        id: orderInfo.id,\n                        orderStatus: orderStatus,\n                    }).then(res => {\n                        if (res.status_code === 1) {\n                            this.$message({\n                                message: '操作成功！',\n                                type: 'success'\n                            });\n                            this.orderInfo.orderStatus = orderStatus;\n                        }\n                    })\n                }\n            },\n        }\n\n    }\n</script>\n\n<style scoped>\n    .order-page-container {\n        min-height: 85vh;\n    }\n\n    .idle-info-container {\n        width: 100%;\n        display: flex;\n        border-bottom: 20px solid #f6f6f6;\n        padding: 20px;\n        cursor: pointer;\n    }\n\n    .idle-info-title {\n        font-size: 18px;\n        font-weight: 600;\n        max-width: 750px;\n        margin-left: 10px;\n    }\n\n    .idle-info-price {\n        font-size: 18px;\n        color: red;\n        margin-left: 10px;\n    }\n\n    .address-container {\n        min-height: 60px;\n        padding: 20px;\n        border-bottom: 20px solid #f6f6f6;\n\n    }\n\n    .address-title {\n        font-size: 18px;\n        font-weight: 600;\n        margin-bottom: 10px;\n    }\n\n    .address-detials {\n        font-size: 16px;\n        color: #444444;\n    }\n\n    .order-info-container {\n        padding: 20px;\n    }\n\n    .order-info-item {\n        margin: 10px 0;\n        font-size: 14px;\n        color: #444444;\n    }\n\n    .menu {\n        margin-left: 20px;\n    }\n</style>"],"sourceRoot":"src/components/page"}]}